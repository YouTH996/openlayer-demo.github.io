(function(){"use strict";var e={3230:function(e,t,n){var o=n(6369),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",{ref:"map",staticClass:"map",attrs:{id:"map"}})])},i=[],a=n(1508),s=n(652),l=n(2949),c=n(7793),u=n(1870),f=n(2188),p=n(9962),d=n(6265),m=n.n(d);m().defaults.headers["Content-Type"]="application/json;charset=utf-8";const h=m().create({baseURL:{NODE_ENV:"production",BASE_URL:""}.VUE_APP_BASE_API,timeout:1e4});function g(e){let t="";for(const n of Object.keys(e)){const o=e[n];let r=encodeURIComponent(n)+"=";if(null!==o&&"undefined"!==typeof o)if("object"===typeof o){for(const e of Object.keys(o))if(null!==o[e]&&"undefined"!==typeof o[e]){let r=n+"["+e+"]",i=encodeURIComponent(r)+"=";t+=i+encodeURIComponent(o[e])+"&"}}else t+=r+encodeURIComponent(o)+"&"}return t}h.interceptors.request.use((e=>{if("get"===e.method&&e.params){let t=e.url+"?"+g(e.params);t=t.slice(0,-1),e.params={},e.url=t}if("post"===e.method||"put"===e.method){e.url,"object"===typeof e.data?JSON.stringify(e.data):e.data,(new Date).getTime()}return e}),(e=>{console.log(e),Promise.reject(e)})),h.interceptors.response.use((e=>e.data),(e=>(console.log("err"+e),Promise.reject(e))));var y=h;function v(e){return y({url:"https://ais.msa.gov.cn/api/app/aisInfo/artAndStaticData",method:"get",params:e})}n(560);var w=n(8437),b=n(7339),P=n(5934),Z=n(4729),S=n(4109),x=n(7712),O=n(9966),j=n(2205),k=n(7983),L=n(3325);let _;function E(e){return new S.Z({visible:!0,preload:1/0,zIndex:-99,source:new L.Z({url:e})})}function I(e,t){t.setFillStrokeStyle(new x.Z({color:e}),new O.Z({color:"black",width:2})),t.drawPolygon(new P.ZP([[[1,1],[11,1],[6,16],[1,1]]]))}function z(e,t){t.setFillStrokeStyle(new x.Z({color:e})),t.drawPolygon(new P.ZP([[[1,1],[11,1],[6,16],[1,1]]]))}function C(e,t){_=document.createElement("canvas"),_.willReadFrequently=!0;let n=(0,Z.Pt)(_.getContext("2d"),{size:[25,25]});return I(e,n),e===t&&z(e,n),_}function R({name:e,sog:t,mmsi:n,cog:o}){console.log(e),console.log(t),console.log(n),console.log(o);let r=[],i=new j.ZP({image:new w.Z({img:C("rgb(0, 255, 0)","rgb(0, 255, 0)"),anchor:[.3,.5],scale:1/window.devicePixelRatio,opacity:.8,imgSize:[_.width,_.height],rotation:Math.PI+Math.PI/(180/o)}),zIndex:99}),a=new j.ZP({image:new b.Z({points:2,radius:15,displacement:[0,15],rotation:45*Math.PI/180,stroke:new O.Z({color:"rgb(0,0,0)"})}),text:new k.Z({font:"16px sans-serif",textAlign:"left",justify:"left",text:e,offsetY:-25,offsetX:25,fill:new x.Z({color:[255,255,255,1]}),backgroundFill:new x.Z({color:[168,50,153,.6]}),padding:[2,2,2,2]})});return r=[i,a],r}function A(e,t){let n=[];for(let o=0;o<Math.ceil(e.length/t);o++){let r=o*t,i=r+t;n.push((0,p.vs)(e.slice(r,i),"EPSG:3857","EPSG:4326"))}return n}function D(e){let t=e.getView().calculateExtent(e.getSize()),n=A(t,2),o=n[0][0]+","+n[0][1],r=n[1][0]+","+n[1][1];return{minPosStr:o,maxPosStr:r}}var F={name:"App",components:{},data(){return{layers:[],shipLayer:void 0,map:void 0,dataList:[]}},mounted(){this.initShipLayer(),this.initLayer(),this.initMap(),this.moveHandler()},methods:{initShipLayer(){this.shipLayer=new f.Z({source:new u.Z({})})},initLayer(){let e=E("http://t{0-4}.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=b37845418765777e2fee031e0b569fbb"),t=E("http://t{0-4}.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=b37845418765777e2fee031e0b569fbb");this.layers=[e,t,this.shipLayer]},initMap(){this.map=new s.Z({layers:this.layers,view:new c.ZP({center:(0,p.mi)([121.1265,33.3186]),zoom:11,minZoom:1,maxZoom:18,constrainResolution:!0,smoothExtentConstraint:!0}),target:this.$refs.map})},shipDataHandler(e){this.getShip(e).then((()=>{const e=this.dataList.map((e=>({geometry:new l.Z((0,p.mi)([e.longitude,e.latitude])),name:e.mmsi.toString(),mmsi:e.mmsi,sog:e.sog,cog:e.cog/10})));e.forEach((e=>{const t=new a.Z({geometry:e.geometry});t.setStyle(R(e)),this.shipLayer.getSource().addFeature(t)}))}))},getShip({minPosStr:e,maxPosStr:t}){return v({lb:e,rt:t}).then((e=>{this.shipLayer.getSource().clear(),this.dataList=e.data}))},moveHandler(){this.map.on("moveend",(()=>{if(this.zoom=this.map.getView().getZoom().toFixed(0),!(this.zoom<11)&&this.map){let e=D(this.map);this.shipDataHandler(e)}}))}}},M=F,T=n(1001),U=(0,T.Z)(M,r,i,!1,null,null,null),H=U.exports;o.ZP.config.productionTip=!1,new o.ZP({render:e=>e(H)}).$mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,i){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],i=e[u][2];for(var s=!0,l=0;l<o.length;l++)(!1&i||a>=i)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(s=!1,i<a&&(a=i));if(s){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,r,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,i,a=o[0],s=o[1],l=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var u=l(n)}for(t&&t(o);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},o=self["webpackChunkopenlayer_demo"]=self["webpackChunkopenlayer_demo"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(3230)}));o=n.O(o)})();
//# sourceMappingURL=app.038355b1.js.map