(function(){"use strict";var e={1840:function(e,t,i){var o=i(6369),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",{ref:"map",staticClass:"map",attrs:{id:"map"}}),t("search-box"),e.detailBoxVisible?t("detail-box",{ref:"detailBox",on:{detailBoxClose:function(t){e.detailBoxVisible=!1}}}):e._e()],1)},r=[],l=i(1508),a=i(652),s=i(2949),c=i(7793),m=i(1870),u=i(2188),d=i(9962),p=i(6265),f=i.n(p);f().defaults.headers["Content-Type"]="application/json;charset=utf-8";const h=f().create({baseURL:{NODE_ENV:"production",BASE_URL:""}.VUE_APP_BASE_API,timeout:1e4});function v(e){let t="";for(const i of Object.keys(e)){const o=e[i];let n=encodeURIComponent(i)+"=";if(null!==o&&"undefined"!==typeof o)if("object"===typeof o){for(const e of Object.keys(o))if(null!==o[e]&&"undefined"!==typeof o[e]){let n=i+"["+e+"]",r=encodeURIComponent(n)+"=";t+=r+encodeURIComponent(o[e])+"&"}}else t+=n+encodeURIComponent(o)+"&"}return t}h.interceptors.request.use((e=>{if(e.url.includes("hljk.axfiber.com")&&(e.headers["Authorization"]="Bearer eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6ImVjNWI1ODEyLTNkNTYtNDA1OS1iN2U1LTg1NTY2OTIyZjgyZiJ9.jRZaeoWt6MOIjurwXw_Of9hq46d-RqyMMy9tgZrAqXyq2gpZqITj6ckUWiYvNpAzKodOETr7oUjvQ4Y72wdJYA"),"get"===e.method&&e.params){let t=e.url+"?"+v(e.params);t=t.slice(0,-1),e.params={},e.url=t}if("post"===e.method||"put"===e.method){e.url,"object"===typeof e.data?JSON.stringify(e.data):e.data,(new Date).getTime()}return e}),(e=>{console.log(e),Promise.reject(e)})),h.interceptors.response.use((e=>e.data),(e=>(console.log("err"+e),Promise.reject(e))));var b=h;function g(e){return b({url:"https://ais.msa.gov.cn/api/app/aisInfo/artAndStaticData",method:"get",params:e})}function _(e){return b({url:"http://hljk.axfiber.com/prod-api/monitoring/ais/static/getInfoByMmsi/"+e,method:"get"})}i(560);var y=i(8437),x=i(7339),w=i(5934),S=i(4729),Z=i(4109),P=i(7712),k=i(9966),O=i(2205),j=i(7983),I=i(3325);let T;function L(e){return new Z.Z({visible:!0,preload:1/0,zIndex:-99,source:new I.Z({url:e})})}function M(e,t){t.setFillStrokeStyle(new P.Z({color:e}),new k.Z({color:"black",width:2})),t.drawPolygon(new w.ZP([[[1,1],[11,1],[6,16],[1,1]]]))}function z(e,t){t.setFillStrokeStyle(new P.Z({color:e})),t.drawPolygon(new w.ZP([[[1,1],[11,1],[6,16],[1,1]]]))}function A(e,t){T=document.createElement("canvas"),T.willReadFrequently=!0;let i=(0,S.Pt)(T.getContext("2d"),{size:[25,25]});return M(e,i),e===t&&z(e,i),T}function E({name:e,sog:t,cog:i}){let o=[],n=new O.ZP({image:new y.Z({img:A("rgb(0, 255, 0)","rgb(0, 255, 0)"),anchor:[.3,.5],scale:1/window.devicePixelRatio,opacity:.8,imgSize:[T.width,T.height],rotation:Math.PI+Math.PI/(180/i)}),zIndex:99}),r=new O.ZP({image:new x.Z({points:2,radius:15,displacement:[0,15],rotation:45*Math.PI/180,stroke:new k.Z({color:"rgb(0,0,0)"})}),text:new j.Z({font:"16px sans-serif",textAlign:"left",justify:"left",text:e,offsetY:-25,offsetX:25,fill:new P.Z({color:[255,255,255,1]}),backgroundFill:new P.Z({color:[168,50,153,.6]}),padding:[2,2,2,2]})});return o=[n,r],o}function B(e,t){let i=[];for(let o=0;o<Math.ceil(e.length/t);o++){let n=o*t,r=n+t;i.push((0,d.vs)(e.slice(n,r),"EPSG:3857","EPSG:4326"))}return i}function C(e){let t=e.getView().calculateExtent(e.getSize()),i=B(t,2),o=i[0][0]+","+i[0][1],n=i[1][0]+","+i[1][1];return{minPosStr:o,maxPosStr:n}}var U=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"search-box"}},[t("el-input",{staticStyle:{width:"445px"},model:{value:e.kw,callback:function(t){e.kw=t},expression:"kw"}}),t("el-button",{attrs:{icon:"el-icon-search",type:"primary"}})],1)},V=[],N={name:"search_box",data(){return{kw:""}},methods:{dataFormSubmit(){}}},R=N,D=i(1001),F=(0,D.Z)(R,U,V,!1,null,null,null),q=F.exports,H=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"detail-box"}},[t("el-card",[t("el-descriptions",{staticClass:"margin-top",attrs:{title:"AIS信息",column:2,size:"medium",border:""}},[t("template",{slot:"extra"},[t("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-close",circle:""},on:{click:e.close}})],1),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" MMSI: ")]),e._v(" "+e._s(e.form.mmsi)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 船首向: ")]),e._v(" "+e._s(e.form.trueHeading)+"度 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 呼号: ")]),e._v(" "+e._s(e.form.callSign)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 航向: ")]),e._v(" "+e._s(e.form.cog)+"度 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" IMO: ")]),e._v(" "+e._s(e.form.imoNumber)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 航速: ")]),e._v(" "+e._s(e.form.sog)+"节 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 类型: ")]),e._v(" "+e._s(e.form.shipTypeText)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 纬度: ")]),e._v(" "+e._s(e.form.latitude)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 状态: ")]),e._v(" "+e._s(e.form.navigationText)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 经度: ")]),e._v(" "+e._s(e.form.longitude)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 船长: ")]),e._v(" "+e._s(e.form.shipLength)+"米 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 目的地: ")]),e._v(" "+e._s(e.form.destination)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 船宽: ")]),e._v(" "+e._s(e.form.shipWidth)+"米 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 预到时间: ")]),e._v(" "+e._s(e.form.sog)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 吃水: ")]),e._v(" "+e._s(e.form.eatTime)+"米 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 更新时间: ")]),e._v(" "+e._s(e.form.updateDateTime)+" ")],2)],2)],1)],1)},J=[],Y={name:"search_box",data(){return{form:""}},methods:{init({mmsi:e}){_(e).then((e=>{this.form=e.data}))},close(){this.$emit("detailBoxClose")}}},$=Y,W=(0,D.Z)($,H,J,!1,null,null,null),X=W.exports,G={name:"App",components:{searchBox:q,detailBox:X},data(){return{layers:[],shipLayer:void 0,map:void 0,dataList:[],detailBoxVisible:!1}},mounted(){this.initShipLayer(),this.initLayer(),this.initMap(),this.moveHandler(),this.clickHandler()},methods:{initShipLayer(){this.shipLayer=new u.Z({source:new m.Z({})})},initLayer(){let e=L("http://t{0-4}.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=b37845418765777e2fee031e0b569fbb"),t=L("http://t{0-4}.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=b37845418765777e2fee031e0b569fbb");this.layers=[e,t,this.shipLayer]},initMap(){this.map=new a.Z({controls:[],layers:this.layers,view:new c.ZP({center:(0,d.mi)([121.1265,33.3186]),zoom:11,minZoom:1,maxZoom:18,constrainResolution:!0,smoothExtentConstraint:!0}),target:this.$refs.map})},shipDataHandler(e){this.getShip(e).then((()=>{this.dataList.forEach((e=>{const t=new l.Z({geometry:new s.Z((0,d.mi)([e.longitude,e.latitude])),name:e.shipname||e.mmsi.toString(),mmsi:e.mmsi,sog:e.sog,cog:e.cog/10});t.setStyle(E(t.values_)),this.shipLayer.getSource().addFeature(t)}))}))},getShip({minPosStr:e,maxPosStr:t}){return g({lb:e,rt:t}).then((e=>{this.shipLayer.getSource().clear(),this.dataList=e.data}))},moveHandler(){this.map.on("moveend",(()=>{if(this.zoom=this.map.getView().getZoom().toFixed(0),!(this.zoom<11)&&this.map){let e=C(this.map);this.shipDataHandler(e)}})),this.map.on("pointermove",(e=>{this.map.hasFeatureAtPixel(e.pixel)?this.map.getViewport().style.cursor="pointer":this.map.getViewport().style.cursor="inherit"}))},clickHandler(){this.map.on("singleclick",(e=>{const t=this.map.forEachFeatureAtPixel(e.pixel,(e=>e));t&&(this.detailBoxVisible=!0,this.$nextTick((()=>{this.$refs["detailBox"].init(t.values_)})))}))}}},K=G,Q=(0,D.Z)(K,n,r,!1,null,null,null),ee=Q.exports,te=i(8499),ie=i.n(te);o["default"].use(ie()),o["default"].config.productionTip=!1,new o["default"]({render:e=>e(ee)}).$mount("#app")}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.m=e,function(){i.amdO={}}(),function(){var e=[];i.O=function(t,o,n,r){if(!o){var l=1/0;for(m=0;m<e.length;m++){o=e[m][0],n=e[m][1],r=e[m][2];for(var a=!0,s=0;s<o.length;s++)(!1&r||l>=r)&&Object.keys(i.O).every((function(e){return i.O[e](o[s])}))?o.splice(s--,1):(a=!1,r<l&&(l=r));if(a){e.splice(m--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var m=e.length;m>0&&e[m-1][2]>r;m--)e[m]=e[m-1];e[m]=[o,n,r]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,r,l=o[0],a=o[1],s=o[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(n in a)i.o(a,n)&&(i.m[n]=a[n]);if(s)var m=s(i)}for(t&&t(o);c<l.length;c++)r=l[c],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(m)},o=self["webpackChunkopenlayer_demo"]=self["webpackChunkopenlayer_demo"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[998],(function(){return i(1840)}));o=i.O(o)})();
//# sourceMappingURL=app.88f26807.js.map